using System.Collections;
using System.Collections.Generic;
using UnityEngine;

//-----------------------------------------------------------------------------------------------------------------------------------
// 기업 정보를 처리하기 위한 클래스
//-----------------------------------------------------------------------------------------------------------------------------------
public class CCompany : MonoBehaviour
{
	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
    [System.Serializable]
    public class tagData
    {
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		public List<tagCompany>		Companies		= new List<tagCompany>();
		public List<string>			Reserves		= new List<string>();

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
    };
    public tagData		data		= new tagData();

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	protected CApp		app			= (null);
	protected CPlay		play		= (null);

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	void OnEnable()
	{
		(this.app)		= (CApp.This);
		(this.play)		= (CPlay.This);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	void Update()
	{
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( (Reserves().Count)>(0) )
		{
			ManagementHash.RequestCompany( Reserves() );
			Reserves().Clear();
		}

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		Enable( false );

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 인물 정보를 등록하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public tagCompany Register( AppsParameter col )
	{
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( (col)==(null) ) return (null);

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		tagCompany company = Find( col.Get("id") );
		if( (company)==(null) )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(company) = new tagCompany();
			GetList().Add( company );

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(company.id)	= col.Get("id");

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
		}

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( (company)!=(null) )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(company.name)		= col.Get("name");

			//-----------------------------------------------------------------------------------------------------------------------
		    // -
		    //-----------------------------------------------------------------------------------------------------------------------
			(company.nation)	= app.NationStatic.Find(col.Get("nation"));
			(company.since)		= col.GetInt("since");
			(company.owner)		= app.Identity.Create( CIdentity.Parse(col.Get("owner_type")), col.Get("owner") );

			//-----------------------------------------------------------------------------------------------------------------------
		    // 최고경영자 (CEO)
		    //-----------------------------------------------------------------------------------------------------------------------
			if( col.Is("manager") )
			{
				tagPerson	manager		= app.Person.Find(col.Get("manager"));
				if( (manager)!=(null) )
				{
					(company.manager)	= (manager);
				}
				else
				{
					(company.manager)	= col.Get("manager");
				}
			}

			//-----------------------------------------------------------------------------------------------------------------------
		    // 이미지
		    //-----------------------------------------------------------------------------------------------------------------------
			long picture_upload_time = col.GetLong("picture_upload_time");
			if( GetPictureTime(company)<(picture_upload_time) )
			{
				PictureDownload( (company), col.Get("picture"), (picture_upload_time) );
			}
			else
			if( Func.IsFile(GetPicturePath(company)) )
			{
				/*
				(company.picture)	= new tagTexture(GetPicturePath(company));
				if( (company.picture)!=(null) )
				{
					(company.picture.cache)	= Func.GetFileModifyTime(GetPicturePath(company));
				}
				*/
			}

			//-----------------------------------------------------------------------------------------------------------------------
		    // -
		    //-----------------------------------------------------------------------------------------------------------------------
			(company.stock.value)	= col.GetFloat("stock_value");
//			(company.stock.amount)	= col.GetDecimal("stock_amount");
			(company.stock.count)	= col.GetInt("stock_count");
			(company.stock.remain)	= col.GetInt("stock_remain");
			(company.stock.percent)	= col.GetFloat("stock_percent");
			(company.stock.change)	= col.GetFloat("stock_change");

			//-----------------------------------------------------------------------------------------------------------------------
		    // -
		    //-----------------------------------------------------------------------------------------------------------------------
//			(company.color)	= CXml.convertColor(col.Get("color"));

			//-----------------------------------------------------------------------------------------------------------------------
		    // -
		    //-----------------------------------------------------------------------------------------------------------------------
		}

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		return (company);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 리스트를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public List<tagCompany> GetList()
	{
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		return (data.Companies);

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 기업을 검색하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public tagCompany Find( string id )
	{
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( !Func.Is(id) ) return (null);

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		foreach( tagCompany company in GetList() )
		{
			if( (company.id)==(id) )
			{
				return (company);
			}
		}

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		return (null);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 이름을 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public string GetName( tagCompany company )
	{
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( (company)==(null) ) return "(NOTHING)";

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		return (company.name);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// ID를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public string GetID( tagCompany company )
	{
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( (company)==(null) ) return (null);

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		return (company.id);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 텍스트 입력에 반응하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool IsNameChange( string name )
	{
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
//		if( !Func.Is(name) ) return false;	//(NULL)값을 허용함

        //---------------------------------------------------------------------------------------------------------------------------
        // 처음이나 끝에 공백을 사용할 수 없습니다.
        //---------------------------------------------------------------------------------------------------------------------------
		if( !Func.Is(name) )
		{
			app.Confirm.ON( app.Language.Get(TEXT.이름이_입력되지_않았습니다) );
			return false;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		string	letter	= (null);
		string	result	= (null);
		int		length	= (0);
		int		space	= (0);
		
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		for( int i=0; i<(name.Length); i++ )
		{
			//-----------------------------------------------------------------------------------------------------------------------
		    // -
	        //-----------------------------------------------------------------------------------------------------------------------
			(letter)	= name[i].ToString();

			//-----------------------------------------------------------------------------------------------------------------------
		    // -
	        //-----------------------------------------------------------------------------------------------------------------------
			if( (i)==(0) && ( Func.IsNumber(letter) || (letter)==" " ) )
			{
				app.Confirm.ON( app.Language.Get(TEXT.첫글자는_영문이어야_합니다) );
				return false;
			}
			else
			if( Func.IsSpecialChar(letter) )
			{
				app.Confirm.ON( app.Language.Get(TEXT.특수문자는_사용할_수_없습니다) );
				return false;
			}
			else
			if( Func.IsAlphabetAndNumber(letter) )
			{
				(length)	+= (1);
			}
			else
			{
				(length)	+= (2);
			}

			//-----------------------------------------------------------------------------------------------------------------------
		    // -
	        //-----------------------------------------------------------------------------------------------------------------------
			if( (length)>(16) )
			{
				app.Confirm.ON( app.Language.Get(TEXT.영문_16글자까지만_가능합니다) );
				return false;
			}

			//-----------------------------------------------------------------------------------------------------------------------
		    // -
	        //-----------------------------------------------------------------------------------------------------------------------
			if( (letter)==" " )
			{
				(space)	+= (1);
			}

			//-----------------------------------------------------------------------------------------------------------------------
		    // -
	        //-----------------------------------------------------------------------------------------------------------------------
			(result)	+= (letter);

			//-----------------------------------------------------------------------------------------------------------------------
		    // -
	        //-----------------------------------------------------------------------------------------------------------------------
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // 처음이나 끝에 공백을 사용할 수 없습니다.
        //---------------------------------------------------------------------------------------------------------------------------
		if( (name[0])==' ' || (name[name.Length-1])==' ' )
		{
			app.Confirm.ON( app.Language.Get(TEXT.처음이나_끝에_공백을_사용할_수_없습니다) );
			return false;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // 공백을 3개 이상 사용할 수 없습니다.
        //---------------------------------------------------------------------------------------------------------------------------
		if( (space)>(2) )
		{
			app.Confirm.ON( app.Language.Get(TEXT.공백을_3개_이상_사용할_수_없습니다) );
			return false;
		}

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
		return true;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
    public void funcNameChange( object wParam=(null), object lParam=(null) )
    {
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (lParam)==(null) || lParam.GetType()!=typeof(string) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		string name = (lParam as string).Trim();

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (Get().name)==(name) )
		{
			app.ViewInput.OFF();
			return;
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( IsNameChange(name) )
		{
			app.ViewIndigator.ON( (this), app.Language.Get(TEXT.기업_이름을_변경하는_중입니다) );
			ManagementHash.CompanyNameChange( Get(), (name) );
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
    }

	//-------------------------------------------------------------------------------------------------------------------------------
	// 창업을 처리하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public void Foundation()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		app.ViewInput.ON( app.Language.Get(TEXT.기업_이름을_입력해주세요), (null), (funcFoundation_), (null), (null) );

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 창업을 처리하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	void funcFoundation_( object wParam=(null), object lParam=(null) )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
//		if( (lParam)==(null) || lParam.GetType()!=typeof(string) ) return;	//(NULL)값을 허용함

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		string name = (lParam as string);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( !Func.Is(name) )
		{
			//이름이 입력되지 않음
			app.Confirm.ON( app.Language.Get(TEXT.무작위_이름을_사용하시겠습니까), (CONFIRM.YESNO), (funcFoundation), (true), (name) );
		}
		else
		if( IsNameChange(name) )
		{
			app.Confirm.ON( app.Language.Get(TEXT.새로운_기업을_창업하시겠습니까), (CONFIRM.YESNO), (funcFoundation), (wParam), (lParam) );
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 창업을 처리하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public void funcFoundation( object wParam=(null), object lParam=(null) )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
//		if( (wParam)==(null) || wParam.GetType()!=typeof(bool) ) return;	//(NULL)값을 허용함
//		if( (lParam)==(null) || lParam.GetType()!=typeof(string) ) return;	//(NULL)값을 허용함

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		string name = (lParam as string);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( Func.Is(name) || ( (wParam)!=(null) && wParam.GetType()==typeof(bool) && (bool)(wParam) ) )
		{
			app.ViewIndigator.ON( (this), app.Language.Get(TEXT.기업을_창업중입니다) );
			ManagementHash.Foundation( name );
		}
		else
		{
			Foundation();
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 기업 소유주인지 확인하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool IsOwner( tagCompany company, tagPerson person )
	{
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( (company)==(null) ) return false;
		if( (person)==(null) ) return false;

		//---------------------------------------------------------------------------------------------------------------------------
		// 소유 기업 (COMPANY)
		//---------------------------------------------------------------------------------------------------------------------------
		if( app.Identity.Is( (company.owner), (person) ) )
		{
			return true;
		}

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 기업 소유주인지 확인하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool IsManager( tagCompany company, tagPerson person )
	{
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( (company)==(null) ) return false;
		if( (person)==(null) ) return false;

	    //---------------------------------------------------------------------------------------------------------------------------
        // 최고 경영자 (CEO)
	    //---------------------------------------------------------------------------------------------------------------------------
		if( company.Manager()==(person) )
		{
			return true;
		}

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 기업에 권한이 있는지 확인하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool IsRight( tagCompany company, tagPerson person )
	{
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( (company)==(null) ) return false;
		if( (person)==(null) ) return false;

		//---------------------------------------------------------------------------------------------------------------------------
		// 소유 기업 (COMPANY)
		//---------------------------------------------------------------------------------------------------------------------------
		if( IsOwner( (company), (person) ) )
		{
			return true;
		}

	    //---------------------------------------------------------------------------------------------------------------------------
        // 최고 경영자 (CEO)
	    //---------------------------------------------------------------------------------------------------------------------------
		if( IsManager( (company), (person) ) )
		{
			return true;
		}

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 기업에 권한이 있는지 확인하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool IsRight( tagCompany company )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (company)==(null) ) return false;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( app.Identity.IsCompany() )
		{
			if( (company)==app.Identity.Company() )
			{
				return true;
			}
		}
		else
		{
			if( IsRight( (company), app.Player.Person() ) )
			{
				return true;
			}
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 기업 소유주인지 확인하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool IsOwner( tagCompany company )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (company)==(null) ) return false;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( IsOwner( (company), app.Player.Person() ) )
		{
			return true;
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (company.owner.type)==(IDENTITY.COMPANY) )
		{
			if( IsOwner(company.owner.Company()) )
			{
				return true;
			}
			else
			if( company.owner.Company()==(null) )
			{
				Debug.Log( "기업 정보 로드가 필요함 : "+(company.owner.obj) );
			}
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 기업 정보를 설정하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public void Set( ref object _company, string id )
	{
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( !Func.Is(id) ) return;

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		tagCompany company = app.Company.Find(id);
		if( (company)!=(null) )
		{
			(_company)	= (company);
		}
		else
		{
			(_company)	= (id);
		}

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 기업 정보를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public tagCompany Get()
	{
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		return app.Identity.Company();

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 기업 정보를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public tagCompany Get( ref object obj )
	{
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( (obj)==(null) ) return (null);

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( obj.GetType()==typeof(tagCompany) )
		{
			return (obj as tagCompany);
		}
		else
		if( obj.GetType()==typeof(string) )
		{
			tagCompany company = app.Company.Find(obj as string);
			if( (company)!=(null) )
			{
				(obj)	= (company);
				return (company);
			}
		}

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		return (null);
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 기업 정보를 확인하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public bool Is( tagCompany company )
	{
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( (company)==(null) ) return false;

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		if( Func.Is(company.id) )
		{
			return true;
		}

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
		return false;
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 기업 정보 요청을 예약하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public void Reserve( string id )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( !Func.Is(id) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( !Reserves().Contains(id) )
		{
			Reserves().Add( id );
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (Reserves().Count)>(0) )
		{
			Enable();
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 예약 리스트를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	public List<string> Reserves()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return (data.Reserves);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 기업 정보 요청을 예약하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	void Enable( bool enable=(true) )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (enabled)!=(enable) )
		{
			(enabled)	= (enable);
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 이미지 캐시 시간을 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	long GetPictureTime( tagCompany company )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( !Is(company) ) return (0);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (company.picture)!=(null) )
		{
			return (company.picture.cache);
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return Func.GetFileModifyTime(GetPicturePath(company));
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 이미지 캐시 시간을 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	string GetPicturePath()
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return CEngine.GetPath()+"/Company-Pictures";

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// 이미지 캐시 시간을 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
	string GetPicturePath( tagCompany company )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( !Is(company) ) return (null);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		return GetPicturePath()+"/"+(company.id)+".jpg";
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	public void PictureDownload( tagCompany company, string Url, long cache )
	{
		/*
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (company)==(null) ) return;
		if( !Func.Is(Url) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		tagDownload download = app.Download.ON( new tagTexture(Url), (funcPictureDownload), (company) );
		if( (download)!=(null) && (download.texture)!=(null) )
		{
			(download.texture.cache)			= (cache);
			(download.texture.isStreamingSave)	= (false);
			(download.texture.isCacheSave)		= (false);
			(download.texture.isBinaryLoad)		= (true);
		}
		*/

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
	void funcPictureDownload( object wParam=(null), object lParam=(null) )
	{
		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (wParam)==(null) || wParam.GetType()!=typeof(tagCompany) ) return;
		if( (lParam)==(null) || lParam.GetType()!=typeof(tagTexture) ) return;

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		tagCompany	company		= (wParam as tagCompany);
		tagTexture	texture		= (lParam as tagTexture);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		(company.picture)	= (texture);

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( true )
		{
			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			Object[] objArray = (null);

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
			(objArray) = FindObjectsOfType( typeof(uiCompany), (true) );
			foreach( uiCompany icon in objArray )
			{
				if( icon.Get()==(company) )
				{
					(icon.Image().texture)	= texture.GetTexture();
					(icon.Image().color)	= (Color.white);
				}
			}

			//---------------------------------------------------------------------------------------------------------------------------
			// -
			//---------------------------------------------------------------------------------------------------------------------------
			(objArray) = FindObjectsOfType( typeof(uiIdentity), (true) );
			foreach( uiIdentity icon in objArray )
			{
				if( icon.Company()==(company) )
				{
					(icon.Image().texture)	= texture.GetTexture();
					(icon.Image().color)	= (Color.white);
				}
			}

			//-----------------------------------------------------------------------------------------------------------------------
			// -
			//-----------------------------------------------------------------------------------------------------------------------
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
		if( (texture.bytes)!=(null) )
		{
			Func.CreateDirectory(GetPicturePath());
			Func.WriteAllBytes( GetPicturePath(company), (texture.bytes) );
			(texture.bytes)	= (null);
		}

		//---------------------------------------------------------------------------------------------------------------------------
		// -
		//---------------------------------------------------------------------------------------------------------------------------
	}

	//-------------------------------------------------------------------------------------------------------------------------------
	// -
	//-------------------------------------------------------------------------------------------------------------------------------
}

//-----------------------------------------------------------------------------------------------------------------------------------
// -
//-----------------------------------------------------------------------------------------------------------------------------------