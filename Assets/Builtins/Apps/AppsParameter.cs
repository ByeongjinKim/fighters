using System.Collections;
using UnityEngine.Networking;

public class AppsParameter
{
	private Hashtable		hash	= null;
    public ArrayList		array	= null;
    public UnityWebRequest	www		= null;

    AppsParameter( string value )
    {
        array = SemsJSONExtensions.arrayListFromJson( value );
    }

    AppsParameter( Hashtable hash )
    {
		this.hash = hash;
    }

    public static AppsParameter JsonParse( string text )
    {
        if( !Library.Is(text) ) return null;
        return new AppsParameter( text );
    }

    public static AppsParameter Initialize( Hashtable hash )
    {
        if( hash==null ) return null;
	    return new AppsParameter( hash );
    }

	//-------------------------------------------------------------------------------------------------------------------------------
    // JSON 포맷을 해제하기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
    public static AppsParameter Decode( string text )
    {
	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
        if( (text)==(null) ) return (null);

	    //---------------------------------------------------------------------------------------------------------------------------
        // -
	    //---------------------------------------------------------------------------------------------------------------------------
        return Initialize( AppsJson.jsonDecode(text) as Hashtable );
    }

	//-------------------------------------------------------------------------------------------------------------------------------
	// 파라메터 정보를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
    public bool Is( string column )
    {
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        if( (column)==(null) ) return false;
        if( (hash)==(null) ) return false;

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        if( hash.Contains(column) )
        {
			return true;
        }

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        return false;
    }

	//-------------------------------------------------------------------------------------------------------------------------------
	// 파라메터 정보를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
    public string Get( string column )
    {
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        if( Func.IsBlank(column) ) return (null);
        if( (hash)==(null) ) return (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        if( hash.Contains(column) )
        {
            if( (hash[column])!=(null) )
            {
                return hash[column].ToString();
            }
        }

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        return (null);
    }

	//-------------------------------------------------------------------------------------------------------------------------------
	// 불형식의 파라메터 정보를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
    public bool GetBoolean( string column )
    {
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        string      value   = Get(column);
        if( (value)==(null) ) return false;

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        if( (value)==true.ToString() || (value)=="1" )
        {
            return true;
        }

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        return false;
    }

	//파라메터 정보를 얻기 위한 함수
    public int GetInt( string column )
    {
		if( !Library.Is(column) ) return 0;

		string value = Get(column);
		if( !Library.Is(value) ) return 0;

		if( Library.IsNumber(value) )
		{
			return System.Convert.ToInt32(value);
		}
		else
		if( Library.IsSingle(value) )
		{
			return (int)System.Convert.ToSingle(value);
		}

		return 0;
    }

	//-------------------------------------------------------------------------------------------------------------------------------
	// 파라메터 정보를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
    public long GetLong( string column )
    {
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        string      value   = Get(column);
        if( Func.IsBlank(value) ) return (0);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        return System.Convert.ToInt64(value);
    }

	//-------------------------------------------------------------------------------------------------------------------------------
	// 파라메터 정보를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
    public float GetFloat( string column )
    {
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        string      value   = Get(column);
        if( Func.IsBlank(value) ) return (0);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        if( Func.IsSingle(value) )
        {
            return System.Convert.ToSingle(value);
        }

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        return (0);
    }

	//-------------------------------------------------------------------------------------------------------------------------------
	// 파라메터 정보를 얻기 위한 함수
	//-------------------------------------------------------------------------------------------------------------------------------
    public object GetNative( string column )
    {
        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        if( Func.IsBlank(column) ) return (null);
        if( (hash)==(null) ) return (null);

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        if( hash.Contains(column) )
        {
            if( (hash[column])!=(null) )
            {
                return (hash[column]);
            }
        }

        //---------------------------------------------------------------------------------------------------------------------------
        // -
        //---------------------------------------------------------------------------------------------------------------------------
        return (null);
    }

	public override string ToString()
	{
		if( hash!=null )
		{
			string text = null;
			if( www!=null )
			{
				text = "("+Get("Compile")+") "+www.url+"\r\n";
			}

			foreach( string key in hash.Keys )
			{
				if( hash[key]!=null && hash[key].GetType()==typeof(Hashtable) )
				{
					text += key+" => "+AppsJson.jsonEncode(hash[key])+"\r\n";
				}
				else
				{
					text += key+" => "+hash[key]+"\r\n";
				}
			}

			return text;
		}
		else
		if( www!=null )
		{
			return www.url;
		}

		return base.ToString();
	}
}